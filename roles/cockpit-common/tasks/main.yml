---
- name: Install packages needed for all nodes 
  yum:
    name: "{{ packages }}"
    state: latest
  vars:
    packages:
    - cockpit
    - cockpit-bridge
    - cockpit-packagekit
    - cockpit-ws
    - cockpit-composer
    - cockpit-pcp
    - cockpit-session-recording
    - cockpit-machines
    - subscription-manager-cockpit
    - cockpit-system
    - cockpit-storaged

- name: Config Cockpit motd
  copy:
    content: "Web console: https://{{ hostvars['master']['ansible_facts']['enp0s8']['ipv4']['address'] }}:9090/@{{ ansible_facts['enp0s8']['ipv4']['address'] }}\n"
    dest: /etc/motd.d/cockpit